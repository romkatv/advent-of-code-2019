#!/usr/bin/env zsh

emulate -L zsh
setopt no_aliases err_return no_unset extended_glob pipe_fail warn_create_global warn_nested_var
setopt ksh_arrays

local -a init
IFS=, read -rA init
(( ${#init[@]} > 2 ))

local noun verb p=()
for noun in {0..99}; do
  for verb in {0..99}; do
    p=(${init[@]})
    p[1,2]=($noun $verb)
    for i in {0..${#p[@]}..4}; do
      case ${p[i]} in
        99) break;;
        1) p[p[i+3]]=$((p[p[i+1]] + p[p[i+2]]));;
        2) p[p[i+3]]=$((p[p[i+1]] * p[p[i+2]]));;
        *) return 1;;
      esac
    done
    if (( p[0] == 19690720 )); then
      echo - $((100 * noun + verb))
      return 0
    fi
  done
done

return 1
