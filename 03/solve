#!/usr/bin/env zsh

emulate -L zsh
setopt no_aliases err_return no_unset extended_glob pipe_fail warn_create_global
setopt ksh_arrays

local -a p
IFS=, read -rA p
(( ${#p[@]} > 2 ))
p[1,2]=(12 2)

local -i i
for i in {0..${#p[@]}..4}; do
  case ${p[i]} in
    99) break;;
    1) p[p[i+3]]=$((p[p[i+1]] + p[p[i+2]]));;
    2) p[p[i+3]]=$((p[p[i+1]] * p[p[i+2]]));;
    *) return 1;;
  esac
done

echo - ${p[0]}
